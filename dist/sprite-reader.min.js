!function t(e,i,a){function s(h,r){if(!i[h]){if(!e[h]){var o="function"==typeof require&&require;if(!r&&o)return o(h,!0);if(n)return n(h,!0);var c=new Error("Cannot find module '"+h+"'");throw c.code="MODULE_NOT_FOUND",c}var _=i[h]={exports:{}};e[h][0].call(_.exports,function(t){var i=e[h][1][t];return s(i?i:t)},_,_.exports,t,e,i,a)}return i[h].exports}for(var n="function"==typeof require&&require,h=0;h<a.length;h++)s(a[h]);return s}({1:[function(t,e,i){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.image,s=void 0===i?null:i,n=e.json,h=void 0===n?null:n,r=e.autoplay,o=void 0===r?!0:r,c=e.canvas,_=void 0===c?null:c,u=e.fillColor,l=void 0===u?null:u,g=e.fps,f=void 0===g?30:g,p=e.from,v=void 0===p?0:p,m=e.loop,d=void 0===m?!1:m,y=e.onReady,k=void 0===y?null:y,C=e.onComplete,w=void 0===C?null:C,x=e.onRepeat,T=void 0===x?null:x,P=e.onRepeatComplete,R=void 0===P?null:P,S=e.repeat,j=void 0===S?0:S,z=e.retina,b=void 0===z?!1:z,E=e.to,M=void 0===E?null:E;if(a(this,t),!s)throw new Error("image parameter can not be null");if(!h)throw new Error("json parameter can not be null");if(s.length&&h.length&&s.length!==h.length)throw new Error("image length must be equal to json length");if(this._image=s,this._json=h,this._canvasCache=[],this._ctxCache=[],this._packCached=0,this._canvasTarget=_||document.createElement("canvas"),this._ctxTarget=null,this._multipackSize=s.length||1,this._currentPack=0,this._currentRepeat=0,this._from=v,this._current=v,this._to=M,this._isPlaying=o,this._repeat=d?-1:j,this._fillColor=l,this._interval=1e3/f,this._then=null,this._onReady=k,this._onComplete=w,this._onRepeat=T,this._onRepeatComplete=R,this._image.length||(this._image=[this._image]),this._json.length||(this._json=[this._json]),null===this._to){for(var O=0,q=0;q<this._multipackSize;q++)O+=this._json[q].frames.length;this._to=O-1}this._side=this._from>this._to?-1:1;for(var I=document.createElement("canvas"),D=0;D<this._multipackSize;D++)this._canvasCache[D]=I.cloneNode(!1),this._canvasCache[D].width=this._json[D].meta.size.w,this._canvasCache[D].height=this._json[D].meta.size.h,this._ctxCache[D]=this._canvasCache[D].getContext("2d");_||(this._canvasTarget.width=this._json[0].frames[0].sourceSize.w,this._canvasTarget.height=this._json[0].frames[0].sourceSize.h,Object.assign(this._canvasTarget.style,{width:this._canvasTarget.width/(b?2:1)+"px",height:this._canvasTarget.height/(b?2:1)+"px"})),this._ctxTarget=this._canvasTarget.getContext("2d"),l&&(this._ctxTarget.fillStyle=l),this.update(!0)}return s(t,[{key:"findPack",value:function(){for(var t=0,e=0;this._current>t;)t+=this._json[e].frames.length,this._current>t&&e++;this._currentPack=e}},{key:"checkPack",value:function(){this.getCurrentRelatedToPack()>this._json[this._currentPack].frames.length-1&&(this._currentPack<this._multipackSize-1?this._currentPack++:this._currentPack=0)}},{key:"getCurrentRelatedToPack",value:function(){for(var t=0,e=0;e<this._currentPack;e++)t+=this._json[e].frames.length;return this._current-t}},{key:"drawCache",value:function(t){var e=document.createElement("canvas"),i=e.getContext("2d");e.width=this._canvasCache[t].width,e.height=this._canvasCache[t].height,i.drawImage(this._image[t],0,0);var a=i.getImageData(0,0,e.width,e.height);this._ctxCache[t].putImageData(a,0,0),this._packCached++,this._packCached===this._multipackSize&&this._onReady&&this._onReady()}},{key:"draw",value:function(){var t=this._canvasTarget;this.checkPack();var e=this._json[this._currentPack].frames[this.getCurrentRelatedToPack()],i={w:e.frame.w,h:e.frame.h},a={x:0,y:0};this._ctxTarget.clearRect(0,0,t.width,t.height),this._fillColor&&this._ctxTarget.fillRect(0,0,t.width,t.height),e.rotated&&(this._ctxTarget.save(),this._ctxTarget.translate(t.width/2,t.height/2),this._ctxTarget.rotate(-Math.PI/2),this._ctxTarget.translate(-t.height/2,-t.width/2),i.w=e.frame.h,i.h=e.frame.w),e.trimmed&&(a.x=e.spriteSourceSize.x,a.y=e.spriteSourceSize.y,e.rotated&&(a.x=t.height-e.spriteSourceSize.h-e.spriteSourceSize.y,a.y=e.spriteSourceSize.x)),this._ctxTarget.drawImage(this._canvasCache[this._currentPack],e.frame.x,e.frame.y,i.w,i.h,a.x,a.y,i.w,i.h),e.rotated&&this._ctxTarget.restore()}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;if(this._packCached<this._multipackSize&&this.drawCache(this._packCached),this._isPlaying||t){var e=performance.now(),i=e-this._then;i<this._interval&&!t||(this._then=e-i%this._interval,this.draw(),this._current===this._to?this._repeat?(this._currentRepeat++,this._current=this._from,this._currentPack=0,this._onRepeat&&this._onRepeat(),this._repeat>0&&this._currentRepeat>this._repeat&&(this._isPlaying=!1,this._onRepeatComplete&&this._onRepeatComplete())):(this._isPlaying=!1,this._onComplete&&this._onComplete()):this._current+=this._side)}}},{key:"play",value:function(){this._isPlaying=!0}},{key:"pause",value:function(){this._isPlaying=!1}},{key:"stop",value:function(){this._isPlaying=!1,this._current=this._from}},{key:"reverse",value:function(t){1===t||-1===t?this._side=t:this._side=1===this._side?-1:1;var e=this._from,i=this._to;1===this._side?this._from=Math.min(e,i):Math.max(e,i),1===this._side?this._to=Math.max(e,i):Math.min(e,i)}},{key:"goFromTo",value:function(t,e){t>=0&&(this._from=t),e>=0&&(this._to=e),this._current=this._from,this._side=t>e?-1:1,this.findPack()}},{key:"goToAndStop",value:function(t){this._current=t,this._isPlaying=!1}},{key:"destroy",value:function(){this._isPlaying=!1,this._ctxTarget.clearRect(0,0,this._canvasTarget.width,this._canvasTarget.height)}},{key:"canvas",get:function(){return this._canvasTarget}},{key:"fps",set:function(t){this._interval=1e3/t}},{key:"loop",set:function(t){t?this._repeat=-1:-1===this._repeat&&(this._repeat=0)}},{key:"repeat",set:function(t){this._repeat=t,this._currentRepeat=0}},{key:"onComplete",set:function(t){this._onComplete=t}},{key:"onRepeat",set:function(t){this._onRepeat=t}},{key:"onRepeatComplete",set:function(t){this._onRepeatComplete=t}}]),t}();i["default"]=n},{}]},{},[1]);
//# sourceMappingURL=sprite-reader.min.js.map